## Front Door

---

### Challenge

The admin of this site is a very special person. He's so special, everyone strives to become him.

[https://front-door.tjc.tf/](https://front-door.tjc.tf/)

---

### Solution

In the temporary account creation page, we first create a fake account.

![image](https://github.com/user-attachments/assets/55a39342-ea5b-4d25-91fb-1627853dfc40)

We navigate to the `PRODUCTS` tab where we find the admin's hashing algorithm.

```
        def has(inp):
            hashed = ""
            key = jwt_key
            for i in range(64):
                hashed = hashed + hash_char(inp[i % len(inp)], key[i % len(key)])
            return hashed

        def hash_char(hash_char, key_char):
            return chr(pow(ord(hash_char), ord(key_char), 26) + 65)
```

There was another code snippet that I found in `/robots.txt` of the website which is an encryption scheme.

```
def encrypt(inp):
  enc = [13]
  for i in range(len(inp)):
    enc.append(ord(inp[i]) ^ 42)
  return enc[1:]
```

We have to gain access to the website as admin so I tried bruteforcing with username: `admin` and password: `admin` and the website called me an imposter. Which means, I am on the right track but I have to authenticate myself in a better way.

Since I logged in as `acy`, the website generated a [JWT token](https://jwt.io/): `eyJhbGciOiAiQURNSU5IQVNIIiwgInR5cCI6ICJKV1QifQ.eyJ1c2VybmFtZSI6ICJhY3kiLCAicGFzc3dvcmQiOiAiYWN5IiwgImFkbWluIjogImZhbHNlIn0.JZOAYHBBBBNBDDQABXBFJOABZBLBBSOBVLBWVBQRSJJBOJYXDQZBEIRQBSOOFFWB`

![image](https://github.com/user-attachments/assets/ca254576-d7d4-413e-87eb-c2267e68edf4)

The hashing algorithm above is probably the core of `ADMINHASH`. I can probably authenticate myself as the admin once I get the token right. This was the token I created: `eyJhbGciOiAiQURNSU5IQVNIIiwgInR5cCI6ICJKV1QifQ.eyJ1c2VybmFtZSI6ICJhZG1pbiIsICJwYXNzd29yZCI6ICJhZG1pbiIsICJhZG1pbiI6ICJ0cnVlIn0.JZOAYHBBBBNBDDQABXBFJOABZBLBBSOBVLBWVBQRSJJBOJYXDQZBEIRQBSOOFFWB`

![image](https://github.com/user-attachments/assets/aa5fb34d-3bcb-44d0-850a-29050c78d3f1)

After navigating to `https://front-door.tjc.tf/user?username=admin` with my new token, I got access as the admin.

![image](https://github.com/user-attachments/assets/3b333fb3-af42-420a-9220-fc83e912aa3c)

In the `TODO` tab of the website, there seems to be an encrypted list. This is where we can reverse the encrypt function we came across earlier and retrieve the original data. I wrote a script for it.

```
encrypted_lists = [
    [108, 67, 82, 10, 77, 70, 67, 94, 73, 66, 79, 89],
    [107, 78, 92, 79, 88, 94, 67, 89, 79, 10, 73, 69, 71, 90, 75, 68, 83],
    [105, 88, 79, 75, 94, 79, 10, 8, 72, 95, 89, 67, 68, 79, 89, 89, 117, 89, 79, 73, 88, 79, 94, 89, 8, 10, 90, 75, 77, 79, 10, 7, 7, 10, 71, 75, 78, 79, 10, 67, 94, 10, 72, 95, 94, 10, 68, 69, 10, 72, 95, 94, 94, 69, 68, 10, 94, 69, 10, 75, 73, 73, 79, 89, 89, 10, 83, 79, 94],
    [126, 75, 65, 79, 10, 69, 92, 79, 88, 10, 94, 66, 79, 10, 93, 69, 88, 70, 78, 10, 7, 7, 10, 75, 70, 71, 69, 89, 94, 10, 78, 69, 68, 79]
]

def decrypt(enc_list):
    return ''.join(chr(num ^ 42) if num != 10 else '\n' for num in enc_list)

# Decrypt and print all messages
for lst in encrypted_lists:
    print(decrypt(lst))
```

The decrypted TODO list tells me to go to `/business_secrets` where the flag will be printed.

![image](https://github.com/user-attachments/assets/e3a38ecc-e504-4588-a1a1-4fafbddcb306)

---

### Flag

`tjctf{buy_h1gh_s3l1_l0w}`
